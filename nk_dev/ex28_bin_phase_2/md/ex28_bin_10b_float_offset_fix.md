# ex28_bin_10b.c ç·ã¾ã¨ã‚ - WAVãƒ•ã‚¡ã‚¤ãƒ«ç§’æ•°æŒ‡å®šèª­ã¿å–ã‚Šãƒ—ãƒ­ã‚°ãƒ©ãƒ 

## ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç›®çš„

ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã§æŒ‡å®šã—ãŸWAVãƒ•ã‚¡ã‚¤ãƒ«ã¨ç§’æ•°ï¼ˆfloatï¼‰ã‹ã‚‰ã€ãã®æ™‚åˆ»ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚Šè¡¨ç¤ºã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€‚

**è¦ä»¶:**
1. ex28_bin_10a.cï¼ˆã‚µãƒ³ãƒ—ãƒ«ç•ªå·æŒ‡å®šç‰ˆï¼‰ã‚’æ‹¡å¼µ
2. ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã§æ™‚åˆ»ã‚’ç§’å˜ä½ï¼ˆå°æ•°ç‚¹å¯¾å¿œï¼‰ã§æŒ‡å®š
3. ãã®æ™‚åˆ»ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’16é€²æ•°ã§è¡¨ç¤º

## ğŸ¯ æœ€çµ‚çµè«–: ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯æ­£ã—ãå‹•ä½œã—ã¦ã„ã‚‹ âœ…

### èª¿æŸ»ã®çµŒç·¯

1. **åˆæœŸã®å•é¡Œ**: 1ç§’æœªæº€ã®WAVãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†ã§è¨ˆç®—ã‚¨ãƒ©ãƒ¼
2. **ä¿®æ­£å¾Œã®è¬**: 0.1, 0.2, 0.3, 0.4, 0.5ç§’ãªã©ã§å¸¸ã« `bin: 0` ãŒå‡ºåŠ›ã•ã‚Œã‚‹
3. **çœŸã®åŸå› **: 440Hzæ­£å¼¦æ³¢ã®ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ç‚¹ã‚’èª­ã¿å–ã£ã¦ã„ãŸï¼ˆå¶ç„¶ï¼‰

### 440Hzæ­£å¼¦æ³¢ã¨44100Hzã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã®æ•°å­¦çš„é–¢ä¿‚

```
ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ: 44100 Hz
éŸ³ã®å‘¨æ³¢æ•°: 440 Hz
1å‘¨æœŸã®ã‚µãƒ³ãƒ—ãƒ«æ•°: 44100 / 440 = 100.227... ã‚µãƒ³ãƒ—ãƒ«

0.1ç§’ = 4410ã‚µãƒ³ãƒ—ãƒ« = 44.00å‘¨æœŸ â†’ ä½ç›¸0Â° (ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹) â†’ 0
0.2ç§’ = 8820ã‚µãƒ³ãƒ—ãƒ« = 88.00å‘¨æœŸ â†’ ä½ç›¸0Â° (ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹) â†’ 0
0.3ç§’ = 13230ã‚µãƒ³ãƒ—ãƒ« = 132.00å‘¨æœŸ â†’ ä½ç›¸0Â° (ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹) â†’ 0
0.4ç§’ = 17640ã‚µãƒ³ãƒ—ãƒ« = 176.00å‘¨æœŸ â†’ ä½ç›¸0Â° (ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹) â†’ 0
0.5ç§’ = 22050ã‚µãƒ³ãƒ—ãƒ« = 220.00å‘¨æœŸ â†’ ä½ç›¸0Â° (ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹) â†’ 0

0.57ç§’ = 25137ã‚µãƒ³ãƒ—ãƒ« = 250.80å‘¨æœŸ â†’ ä½ç›¸288Â° (æ³¢å½¢ã®é€”ä¸­) â†’ 0xC323
```

**ã¤ã¾ã‚Šã€ã‚­ãƒªã®è‰¯ã„æ•°å­—ï¼ˆ0.1, 0.2, ...ï¼‰ãŒå¶ç„¶ã™ã¹ã¦ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ç‚¹ã ã£ãŸã€‚**

### xxdã«ã‚ˆã‚‹ç›´æ¥ç¢ºèªï¼ˆæ±ºå®šçš„ãªè¨¼æ‹ ï¼‰

```bash
# 0.5ç§’ã®ä½ç½®ï¼ˆ44144ãƒã‚¤ãƒˆç›®ï¼‰
$ xxd -s 44144 -l 16 /path/to/sample.wav
0000ac70: 0000 0204 0008 f70b e10f bb13 8217 301b
         ^^^^  # å®Ÿéš›ã« 00 00 (0)

# 0.57ç§’ã®ä½ç½®ï¼ˆ50318ãƒã‚¤ãƒˆç›®ï¼‰
$ xxd -s 50318 -l 16 /path/to/sample.wav
0000c48e: 23c3 7fc4 16c6 e8c7 f2c9 33cc a8ce 4ed1
         ^^^^  # å®Ÿéš›ã« 23 c3 (ãƒªãƒˆãƒ«ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ã§ 0xC323)
```

ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å‡ºåŠ›ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿéš›ã®å†…å®¹ãŒå®Œå…¨ã«ä¸€è‡´ â†’ **ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯100%æ­£ã—ãå‹•ä½œã—ã¦ã„ã‚‹**

---

## ğŸ“Š è¨ºæ–­ãƒ—ãƒ­ã‚»ã‚¹ã§å­¦ã‚“ã ã“ã¨

### 1. ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ï¼ˆstderrï¼‰ã®å®Ÿç”¨æ€§

ä»Šå›ã®èª¿æŸ»ã§ã¯ã€è¨ºæ–­ç”¨ã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« `test_ex28_bin_10b.c` ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®æƒ…å ±ã‚’stderrã«å‡ºåŠ›ï¼š

```c
// === è¨ºæ–­1: WAVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæƒ…å ± ===
fprintf(stderr, "=== WAV Format Info ===\n");
fprintf(stderr, "sample_rate: %u Hz\n", fmt->sample_rate);
fprintf(stderr, "channel_num: %u\n", fmt->channel_num);
fprintf(stderr, "bit_depth: %u bits\n", fmt->bit_depth);
fprintf(stderr, "byte_rate (header): %u bytes/sec\n", fmt->byte_rate);
fprintf(stderr, "block_align (header): %u bytes\n", fmt->block_align);
fprintf(stderr, "bits_per_sample (calc): %u bits\n", bits_per_sample);
fprintf(stderr, "bytes_per_sample (calc): %u bytes\n", bytes_per_sample);
fprintf(stderr, "data_size: %d bytes\n", data_size);

// === è¨ºæ–­2: block_alignãƒã‚§ãƒƒã‚¯ ===
long remainder = byte_offset % fmt->block_align;
fprintf(stderr, "byte_offset %% block_align = %ld", remainder);
if (remainder == 0) {
    fprintf(stderr, " âœ“ (aligned)\n");
} else {
    fprintf(stderr, " âœ— (NOT aligned!)\n");
}

// === è¨ºæ–­3: freadã®è©³ç´°ç¢ºèª ===
size_t read_count = fread(&bin_data, bytes_per_sample, 1, fp);
fprintf(stderr, "fread returned: %zu (expected 1)\n", read_count);
fprintf(stderr, "feof: %d, ferror: %d\n", feof(fp), ferror(fp));
fprintf(stderr, "bin_data (hex): 0x%08X\n", (unsigned int)bin_data);
fprintf(stderr, "bin_data (dec): %d\n", bin_data);
```

**stderrå‡ºåŠ›ã®ãƒ¡ãƒªãƒƒãƒˆ:**
- stdoutã¨ã¯åˆ¥ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ãªã®ã§ã€æ­£è¦ã®å‡ºåŠ›ã¨æ··ã–ã‚‰ãªã„
- ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’ `2>/dev/null` ã§ç°¡å˜ã«éè¡¨ç¤ºã«ã§ãã‚‹
- å•é¡Œç™ºç”Ÿæ™‚ã®çŠ¶æ…‹ã‚’è©³ç´°ã«è¨˜éŒ²ã§ãã‚‹
- æ®µéšçš„ã«ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¿½åŠ ã—ã¦ã„ã‘ã‚‹

### 2. å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã‚‹æ¤œè¨¼ã®é‡è¦æ€§

ä»Šå›ä½¿ç”¨ã—ãŸãƒ„ãƒ¼ãƒ«:

#### **xxd** - 16é€²æ•°ãƒ€ãƒ³ãƒ—ãƒ„ãƒ¼ãƒ«ï¼ˆæœ€ã‚‚é‡è¦ï¼‰

```bash
# åŸºæœ¬çš„ãªä½¿ã„æ–¹
xxd -s [é–‹å§‹ä½ç½®] -l [èª­ã¿å–ã‚Šãƒã‚¤ãƒˆæ•°] [ãƒ•ã‚¡ã‚¤ãƒ«å]

# ä¾‹: 44144ãƒã‚¤ãƒˆç›®ã‹ã‚‰16ãƒã‚¤ãƒˆèª­ã‚€
xxd -s 44144 -l 16 sample.wav
0000ac70: 0000 0204 0008 f70b e10f bb13 8217 301b
         ^^^^
         ã“ã®2ãƒã‚¤ãƒˆãŒèª­ã¿å–ã‚Šçµæœï¼ˆãƒªãƒˆãƒ«ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ï¼‰

# ASCIIè¡¨ç¤ºã‚‚å«ã‚ã‚‹
xxd -s 44 -l 64 sample.wav
0000002c: 0000 0204 0008 f70b e10f bb13 8217 301b  ..............0.
                                                   ^^^^^^^^^^^^^^^^
                                                   ASCIIè¡¨ç¤ºï¼ˆ.ã¯éè¡¨ç¤ºæ–‡å­—ï¼‰
```

**xxdã®æ´»ç”¨å ´é¢:**
- ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒæ­£ã—ã„ä½ç½®ã‚’èª­ã‚“ã§ã„ã‚‹ã‹ç¢ºèª
- ãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ç¢ºèª
- ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±ã®æ¤œè¨¼
- ãƒã‚¤ãƒˆã‚ªãƒ¼ãƒ€ãƒ¼ï¼ˆã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ï¼‰ã®ç¢ºèª

#### **Audacity** - éŸ³å£°æ³¢å½¢ç·¨é›†ã‚½ãƒ•ãƒˆï¼ˆGUIï¼‰

sample.wavã‚’é–‹ã„ã¦è¦–è¦šçš„ã«ç¢ºèªã§ãã‚‹ï¼š
- æ³¢å½¢ã®ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ç‚¹ã‚’è¦–è¦šçš„ã«ç¢ºèª
- ç‰¹å®šã®æ™‚åˆ»ã®ã‚µãƒ³ãƒ—ãƒ«å€¤ã‚’ç›´æ¥è¡¨ç¤º
- å‘¨æ³¢æ•°ã‚¹ãƒšã‚¯ãƒˆãƒ«è§£æ
- å®Ÿéš›ã«éŸ³ã‚’å†ç”Ÿã—ã¦ç¢ºèª

ä½¿ã„æ–¹:
1. Audacityã§sample.wavã‚’é–‹ã
2. è§£æ â†’ ãƒ—ãƒ­ãƒƒãƒˆ â†’ ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ è¡¨ç¤º â†’ 440Hzã®ãƒ”ãƒ¼ã‚¯ã‚’ç¢ºèª
3. ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ä¸Šã§0.5ç§’ã®ä½ç½®ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ç‚¹ã‚’è¦–è¦šç¢ºèª

#### **SoX (Sound eXchange)** - ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³éŸ³å£°å‡¦ç†ãƒ„ãƒ¼ãƒ«

```bash
# WAVãƒ•ã‚¡ã‚¤ãƒ«ã®è©³ç´°æƒ…å ±ã‚’è¡¨ç¤º
sox --info sample.wav
# å‡ºåŠ›:
# Channels       : 1
# Sample Rate    : 44100
# Precision      : 16-bit
# Duration       : 00:00:01.00 = 44100 samples
# File Size      : 88.2k

# ç‰¹å®šã®ã‚µãƒ³ãƒ—ãƒ«å€¤ã‚’è¡¨ç¤º
sox sample.wav -n stat
# å‡ºåŠ›: æœ€å¤§å€¤ã€æœ€å°å€¤ã€RMSå€¤ãªã©çµ±è¨ˆæƒ…å ±

# ç‰¹å®šã®æ™‚åˆ»ã®ã‚µãƒ³ãƒ—ãƒ«å€¤ã‚’å–å¾—ï¼ˆtrim + statï¼‰
sox sample.wav -n trim 0.5 0.001 stat
# 0.5ç§’ã‹ã‚‰0.001ç§’åˆ†ï¼ˆ44ã‚µãƒ³ãƒ—ãƒ«ï¼‰ã®çµ±è¨ˆã‚’è¡¨ç¤º
```

#### **Python + librosa/scipy** - ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ†ã‚£ãƒƒã‚¯ãªæ¤œè¨¼

```python
import librosa
import numpy as np

# WAVãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav', sr=44100, mono=True)

# ç‰¹å®šã®æ™‚åˆ»ã®ã‚µãƒ³ãƒ—ãƒ«å€¤ã‚’å–å¾—
time_sec = 0.5
sample_index = int(time_sec * sr)
sample_value = y[sample_index]
print(f"{time_sec}ç§’ã®ã‚µãƒ³ãƒ—ãƒ«å€¤: {sample_value}")

# 0.5ç§’ã®ä½ç½®ãŒæœ¬å½“ã«ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ç‚¹ã‹ç¢ºèª
samples_around = y[sample_index-5:sample_index+5]
print(f"å‰å¾Œã®ã‚µãƒ³ãƒ—ãƒ«: {samples_around}")

# å‘¨æ³¢æ•°è§£æ
from scipy.fft import fft, fftfreq
fft_vals = fft(y)
freqs = fftfreq(len(y), 1/sr)
# ãƒ”ãƒ¼ã‚¯å‘¨æ³¢æ•°ãŒ440Hzã‹ç¢ºèª
```

**å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã†ã¹ãã‚¿ã‚¤ãƒŸãƒ³ã‚°:**
- è‡ªåˆ†ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å‡ºåŠ›ãŒä¿¡ã˜ã‚‰ã‚Œãªã„ã¨ã
- ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã®å®Ÿéš›ã®å†…å®¹ã‚’ç¢ºèªã—ãŸã„ã¨ã
- è¤‡æ•°ã®æ–¹æ³•ã§åŒã˜çµæœã‚’å¾—ã¦æ¤œè¨¼ã—ãŸã„ã¨ãï¼ˆä»Šå›ã®ã‚±ãƒ¼ã‚¹ï¼‰
- è¦–è¦šçš„ã«ç¢ºèªã—ãŸã„ã¨ãï¼ˆæ³¢å½¢ã€ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ï¼‰

---

## ğŸ”¢ Cè¨€èªã®å‹ã®ä½¿ã„åˆ†ã‘ - å®Ÿè·µçš„ã‚¬ã‚¤ãƒ‰

### åŸºæœ¬åŸå‰‡

| ç”¨é€” | æ¨å¥¨å‹ | ç†ç”± |
|------|--------|------|
| æ•´æ•°ã‚«ã‚¦ãƒ³ãƒˆï¼ˆè² ã§ãªã„ï¼‰ | `uint32_t` | ã‚µã‚¤ã‚ºæ˜ç¢ºã€ç¬¦å·ãªã— |
| ãƒ•ã‚¡ã‚¤ãƒ«ä½ç½®ãƒ»ã‚ªãƒ•ã‚»ãƒƒãƒˆ | `long` | fseek/ftellã¨äº’æ› |
| æ™‚é–“ãƒ»å‘¨æ³¢æ•°è¨ˆç®— | `float` ã¾ãŸã¯ `double` | å°æ•°ç‚¹ãŒå¿…è¦ |
| ãƒã‚¤ãƒˆæ•°ãƒ»ã‚µã‚¤ã‚º | `size_t` | fread/fwriteã®æˆ»ã‚Šå€¤ |
| ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ | `int` | è² ã®å€¤ã§ã‚¨ãƒ©ãƒ¼è¡¨ç¾ |
| ãƒ“ãƒƒãƒˆãƒ•ãƒ©ã‚° | `uint8_t`, `uint16_t` | ãƒ“ãƒƒãƒˆæ“ä½œã«é©ã—ã¦ã„ã‚‹ |

### ä»Šå›ã®ã‚³ãƒ¼ãƒ‰ã§ã®å®Ÿä¾‹

#### âœ… æ­£ã—ã„å‹ã®ä½¿ç”¨ä¾‹

```c
// uint32_t: WAVãƒ˜ãƒƒãƒ€ãƒ¼ã®å›ºå®šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆå¸¸ã«æ­£ã€ã‚µã‚¤ã‚ºæ˜ç¢ºï¼‰
typedef struct {
    char        chunk_id[4];
    uint32_t    chunk_size;     // âœ… å¸¸ã«æ­£ã€4ãƒã‚¤ãƒˆå›ºå®š
    uint16_t    audio_format;   // âœ… å¸¸ã«æ­£ã€2ãƒã‚¤ãƒˆå›ºå®š
    uint16_t    channel_num;    // âœ… å¸¸ã«æ­£ã€2ãƒã‚¤ãƒˆå›ºå®š
    uint32_t    sample_rate;    // âœ… å¸¸ã«æ­£ã€4ãƒã‚¤ãƒˆå›ºå®š
    uint32_t    byte_rate;      // âœ… å¸¸ã«æ­£ã€4ãƒã‚¤ãƒˆå›ºå®š
    uint16_t    block_align;    // âœ… å¸¸ã«æ­£ã€2ãƒã‚¤ãƒˆå›ºå®š
    uint16_t    bit_depth;      // âœ… å¸¸ã«æ­£ã€2ãƒã‚¤ãƒˆå›ºå®š
} FmtHeader;

// long: ãƒ•ã‚¡ã‚¤ãƒ«ä½ç½®ï¼ˆfseek/ftellã¨äº’æ›æ€§ï¼‰
long data_offset = ftell(fp);        // âœ… ftellã®æˆ»ã‚Šå€¤ã¯long
fseek(fp, result_offset, SEEK_SET);  // âœ… fseekã®ç¬¬2å¼•æ•°ã¯long

// float: æ™‚é–“è¨ˆç®—ï¼ˆå°æ•°ç‚¹ãŒå¿…è¦ï¼‰
float need_second = atof(argv[2]);   // âœ… 0.5ç§’ãªã©ã®å°æ•°
float duration = (float)data_size / (float)byte_rate;  // âœ… é™¤ç®—ã®çµæœ

// size_t: freadã®æˆ»ã‚Šå€¤
size_t read_count = fread(&bin_data, bytes_per_sample, 1, fp);  // âœ…

// int: ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ï¼ˆè² ã®å€¤ã§åŒºåˆ¥ï¼‰
int get_bin(...) {
    // ...
    if (error) return -1;  // âœ… ã‚¨ãƒ©ãƒ¼
    return bin_data;        // âœ… æ­£å¸¸ãªãƒ‡ãƒ¼ã‚¿ï¼ˆ0ä»¥ä¸Šï¼‰
}
```

#### âŒ é¿ã‘ã‚‹ã¹ãå‹ã®ä½¿ã„æ–¹

```c
// âŒ int: WAVãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆã‚µã‚¤ã‚ºä¸æ˜ç¢ºã€ç¬¦å·ä¸è¦ï¼‰
int chunk_size;  // 32bitã‹64bitã‹ä¸æ˜ã€è² ã®å€¤ã¯ä¸è¦

// âŒ int: ãƒ•ã‚¡ã‚¤ãƒ«ä½ç½®ï¼ˆå¤§ããªãƒ•ã‚¡ã‚¤ãƒ«ã§æ¡ã‚ãµã‚Œï¼‰
int data_offset = ftell(fp);  // 2GBä»¥ä¸Šã®ãƒ•ã‚¡ã‚¤ãƒ«ã§æ¡ã‚ãµã‚Œ

// âŒ int: æ™‚é–“è¨ˆç®—ï¼ˆå°æ•°ç‚¹ãŒä½¿ãˆãªã„ï¼‰
int need_second = atoi(argv[2]);  // 0.5 â†’ 0 ã«ãªã£ã¦ã—ã¾ã†

// âŒ unsigned int: ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ï¼ˆè² ã®å€¤ãŒä½¿ãˆãªã„ï¼‰
unsigned int get_bin(...) {
    if (error) return -1;  // âŒ è² ã®å€¤ãŒä½¿ãˆãªã„ï¼ˆ4294967295ã«ãªã‚‹ï¼‰
    return bin_data;
}
```

### å‹å¤‰æ›ã®å®Ÿè·µãƒ†ã‚¯ãƒ‹ãƒƒã‚¯

#### 1. æ•´æ•° Ã— æµ®å‹•å°æ•°ç‚¹ â†’ æµ®å‹•å°æ•°ç‚¹

```c
uint32_t byte_rate = 88200;
float need_second = 0.5f;

// âŒ é–“é•ã„: æ•´æ•°åŒå£«ã®æ›ã‘ç®—å¾Œã«floatã‚­ãƒ£ã‚¹ãƒˆ
long byte_offset = (float)(byte_rate * need_second);
// byte_rate * need_second ãŒå…ˆã«æ•´æ•°æ¼”ç®—ã•ã‚Œã¦ã—ã¾ã†

// âœ… æ­£ã—ã„: å…ˆã«floatã«ã‚­ãƒ£ã‚¹ãƒˆã—ã¦ã‹ã‚‰æ›ã‘ç®—
long byte_offset = (long)((float)byte_rate * need_second);
//                        ^^^^^^^^^^^^^^^^  å…ˆã«floatåŒ–
```

#### 2. æ•´æ•° Ã· æ•´æ•° â†’ æµ®å‹•å°æ•°ç‚¹

```c
int data_size = 88200;
uint32_t byte_rate = 88200;

// âŒ é–“é•ã„: æ•´æ•°é™¤ç®—ã®çµæœã‚’floatã‚­ãƒ£ã‚¹ãƒˆ
float duration = (float)(data_size / byte_rate);
// data_size / byte_rate = 1 (æ•´æ•°é™¤ç®—) â†’ 1.0f

// âœ… æ­£ã—ã„: å…ˆã«floatã«ã‚­ãƒ£ã‚¹ãƒˆã—ã¦ã‹ã‚‰é™¤ç®—
float duration = (float)data_size / (float)byte_rate;
// 88200.0f / 88200.0f = 1.0f (æ­£ç¢ºãªçµæœ)
```

#### 3. ç¬¦å·ä»˜ã â†” ç¬¦å·ãªã— å¤‰æ›ã®æ³¨æ„

```c
int bin_data = -1;  // ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰

// âŒ é–“é•ã„: ç¬¦å·ãªã—ã«ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹ã¨å·¨å¤§ãªæ­£ã®å€¤ã«ãªã‚‹
uint32_t unsigned_value = (uint32_t)bin_data;
// -1 â†’ 4294967295 (0xFFFFFFFF)

// âœ… æ­£ã—ã„: å…ˆã«ç¬¦å·ã‚’ãƒã‚§ãƒƒã‚¯
if (bin_data < 0) {
    // ã‚¨ãƒ©ãƒ¼å‡¦ç†
} else {
    uint32_t unsigned_value = (uint32_t)bin_data;  // å®‰å…¨
}
```

### è¤‡åˆçš„ãªå‹ä½¿ç”¨ã®å®Ÿä¾‹

```c
int get_bin(FILE *fp, FmtHeader *fmt, int data_size, long data_offset, float need_second) {

    // 1. WAVãƒ˜ãƒƒãƒ€ãƒ¼ã‹ã‚‰uint32_t/uint16_tã‚’å–å¾—ï¼ˆå‹å®‰å…¨ï¼‰
    uint32_t bits_per_sample = fmt->bit_depth * fmt->channel_num;
    //       ^^^^^^^^          ^^^^^^^^^^^^^^   ^^^^^^^^^^^^^^^^
    //       uint32_t          uint16_t         uint16_t
    //       â†’ uint16_t Ã— uint16_t ã¯è‡ªå‹•çš„ã«intã«æ˜‡æ ¼ã€uint32_tã«ä»£å…¥ã§å®‰å…¨

    uint32_t bytes_per_sample = bits_per_sample / 8;
    //                          ^^^^^^^^^^^^^^^^ æ•´æ•°é™¤ç®—ã§OKï¼ˆ8ã®å€æ•°å‰æï¼‰

    // 2. æµ®å‹•å°æ•°ç‚¹è¨ˆç®—ï¼ˆæ™‚é–“ï¼‰
    float duration = (float)data_size / (float)fmt->byte_rate;
    //               ^^^^^^^^^^^^^^^^^   ^^^^^^^^^^^^^^^^^^^
    //               ä¸¡æ–¹floatã«å¤‰æ›ã—ã¦ã‹ã‚‰é™¤ç®—

    if (duration < need_second) {  // âœ… floatåŒå£«ã®æ¯”è¼ƒ
        return -1;  // ã‚¨ãƒ©ãƒ¼: intå‹ã®æˆ»ã‚Šå€¤
    }

    // 3. æµ®å‹•å°æ•°ç‚¹ â†’ æ•´æ•°å¤‰æ›ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ä½ç½®ï¼‰
    long byte_offset = (long)((float)fmt->byte_rate * need_second);
    //   ^^^^          ^^^^^^  ^^^^^^^^^^^^^^^^^^^^^^ ^^^^^^^^^^^^
    //   long          longâ†   float                Ã— float
    //   ãƒ•ã‚¡ã‚¤ãƒ«ä½ç½®  æœ€å¾Œã«   æ˜ç¤ºçš„ã«floatåŒ–       floatå¼•æ•°
    //               æ•´æ•°åŒ–

    long result_offset = data_offset + byte_offset;
    //                   ^^^^^^^^^^^   ^^^^^^^^^^^
    //                   long          long
    //                   â†’ longåŒå£«ã®åŠ ç®—ã€å®‰å…¨

    // 4. ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ãƒ¼ã‚¯ï¼ˆlongå‹ï¼‰
    if (fseek(fp, result_offset, SEEK_SET) != 0) {
        //        ^^^^^^^^^^^^^
        //        longå‹ã€fseekã®ç¬¬2å¼•æ•°ã¨ä¸€è‡´
        return -1;
    }

    // 5. freadï¼ˆsize_tå‹ï¼‰
    int bin_data = 0;
    size_t read_count = fread(&bin_data, bytes_per_sample, 1, fp);
    //     ^^^^^^              ^^^^^^^^^  ^^^^^^^^^^^^^^^^  ^  ^^^
    //     size_t              void*      size_t            size_t FILE*

    if (read_count != 1) {  // âœ… size_tåŒå£«ã®æ¯”è¼ƒ
        return -1;
    }

    // 6. ãƒ‡ãƒ¼ã‚¿å€¤ã¨ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã®åˆ†é›¢ï¼ˆintå‹æˆ»ã‚Šå€¤ï¼‰
    return bin_data;  // âœ… æ­£å¸¸: 0ä»¥ä¸Šã®å€¤ã€ã‚¨ãƒ©ãƒ¼: -1ï¼ˆè² ã®å€¤ï¼‰
}
```

### printfã§ã®å‹ã«å¿œã˜ãŸæ›¸å¼æŒ‡å®šå­

```c
uint32_t value32 = 88200;
uint16_t value16 = 440;
long offset = 44144;
float time = 0.5f;
size_t count = 1;
int bin_data = 0xC323;

// æ•´æ•°å‹
printf("uint32_t: %u\n", value32);           // %u (unsigned int)
printf("uint16_t: %u\n", value16);           // %u (unsigned int)
printf("int: %d\n", bin_data);               // %d (signed int)

// ãƒ•ã‚¡ã‚¤ãƒ«ä½ç½®
printf("long: %ld\n", offset);               // %ld (long)

// æµ®å‹•å°æ•°ç‚¹
printf("float: %.2f\n", time);               // %.2f (å°æ•°ç‚¹ä»¥ä¸‹2æ¡)
printf("float: %f\n", time);                 // %f (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ6æ¡)

// size_t
printf("size_t: %zu\n", count);              // %zu (size_tå°‚ç”¨)

// 16é€²æ•°
printf("hex: 0x%08X\n", (unsigned int)bin_data);  // %08X (8æ¡ã€0åŸ‹ã‚ã€å¤§æ–‡å­—)
printf("hex: 0x%x\n", bin_data);             // %x (å°æ–‡å­—)

// ãƒã‚¤ãƒ³ã‚¿
printf("pointer: %p\n", (void*)fp);          // %p (ãƒã‚¤ãƒ³ã‚¿)
```

---

## ğŸ› ã‚³ãƒ¼ãƒ‰ã®ä¿®æ­£ãŒå¿…è¦ãªç‚¹

### ä¿®æ­£1: ä¸è¦ãªã‚³ãƒ¡ãƒ³ãƒˆã®å‰Šé™¤

[ex28_bin_10b.c:66-67](ex28_bin_10b.c#L66-L67)

```c
// erroræ™‚ã®æˆ»ã‚Šå€¤ã¯ã€å¿…ãšè² ã®æ•°ã«ã—ãªã„ã¨æ­£ã—ã„å‡ºåŠ›ã¨ã”ã£ã¡ã‚ƒã«ãªã‚‹
// æˆ»ã‚Šå€¤ãŒãŠã‹ã—ã„ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ
```

ã“ã‚Œã‚‰ã®ã‚³ãƒ¡ãƒ³ãƒˆã¯èª¿æŸ»ä¸­ã®ç–‘å•ã§ã€ç¾åœ¨ã¯ä¸è¦ã§ã™ã€‚å‰Šé™¤æ¨å¥¨ã€‚

### ä¿®æ­£2: ã‚¨ãƒ©ãƒ¼æ™‚ã®æˆ»ã‚Šå€¤ã®çµ±ä¸€ç¢ºèª

[ex28_bin_10b.c:92-93](ex28_bin_10b.c#L92-L93)
[ex28_bin_10b.c:98-99](ex28_bin_10b.c#L98-L99)

ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰:
```c
if (fseek(fp, result_offset, SEEK_SET) != 0) {
    fprintf(stderr, "fseek/get_bin: returned error\n");
    return -1;  // âœ… æ­£ã—ã„
}

if (fread(&bin_data, bytes_per_sample, 1, fp) != 1) {
    fprintf(stderr, "fread/get_bin: returned error\n");
    return -1;  // âœ… æ­£ã—ã„
}
```

ã“ã‚Œã¯æ—¢ã«æ­£ã—ãä¿®æ­£ã•ã‚Œã¦ã„ã¾ã™ã€‚ä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ `return 1` ã ã£ãŸãŒã€ç¾åœ¨ã¯ `return -1` ã§çµ±ä¸€ã•ã‚Œã¦ã„ã‚‹ã€‚âœ…

### ä¿®æ­£3: mainé–¢æ•°ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

[ex28_bin_10b.c:182-184](ex28_bin_10b.c#L182-L184)

ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰:
```c
int bin_data = get_bin(fp, &fmt, data_size, data_offset, need_second);
if (bin_data == -1) {
    fprintf(stderr, "get_bin/main: returned error\n");
    return result;  // âŒ å•é¡Œ: result ã¯ process_read ã®æˆ»ã‚Šå€¤ï¼ˆ0ã«ãªã£ã¦ã„ã‚‹ï¼‰
}
```

ä¿®æ­£æ¡ˆ:
```c
int bin_data = get_bin(fp, &fmt, data_size, data_offset, need_second);
if (bin_data == -1) {
    fprintf(stderr, "get_bin/main: returned error\n");
    fclose(fp);  // ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‰ã˜ã‚‹
    return 1;    // âœ… ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰1ã‚’è¿”ã™
}
```

**å•é¡Œç‚¹:**
- `return result` ã¯ `process_read` ã®æœ€å¾Œã®æˆ»ã‚Šå€¤ï¼ˆã“ã®æ™‚ç‚¹ã§0ï¼‰ã‚’è¿”ã™ãŸã‚ã€ã‚¨ãƒ©ãƒ¼ãªã®ã«æˆåŠŸã‚’è¿”ã—ã¦ã—ã¾ã†
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‰ã˜ãšã«returnã—ã¦ã„ã‚‹ï¼ˆãƒªã‚½ãƒ¼ã‚¹ãƒªãƒ¼ã‚¯ï¼‰

### ä¿®æ­£4: å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ”¹å–„ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

[ex28_bin_10b.c:187-189](ex28_bin_10b.c#L187-L189)

ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰:
```c
printf("=== Result ===\n");
printf("bin: %0x", bin_data);  // âŒ å•é¡Œ: %0xã¯æ„å‘³ãŒãªã„ï¼ˆ%xã«åŒã˜ï¼‰
printf("\n");
```

æ”¹å–„æ¡ˆ:
```c
printf("=== Result ===\n");
printf("bin: 0x%04X\n", (unsigned int)bin_data);  // âœ… 4æ¡16é€²æ•°ã€0åŸ‹ã‚ã€å¤§æ–‡å­—
// ã¾ãŸã¯
printf("bin: 0x%x (%d)\n", bin_data, bin_data);   // âœ… 16é€²æ•°ã¨10é€²æ•°ã‚’ä¸¡æ–¹è¡¨ç¤º
```

**æ”¹å–„ç‚¹:**
- `%0x` ã¯ `%x` ã¨åŒã˜ï¼ˆæ¡æ•°æŒ‡å®šãŒãªã„ãŸã‚ï¼‰
- `%04X` ã«ã™ã‚‹ã¨4æ¡0åŸ‹ã‚ï¼ˆä¾‹: 0x00C3ï¼‰
- `(unsigned int)` ã‚­ãƒ£ã‚¹ãƒˆã§ç¬¦å·ä»˜ã/ç¬¦å·ãªã—ã®è­¦å‘Šã‚’å›é¿
- 10é€²æ•°ã‚‚è¡¨ç¤ºã™ã‚‹ã¨ç†è§£ã—ã‚„ã™ã„

### ä¿®æ­£5: ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã®æ•´ç†ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

ç¾åœ¨ã®ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›:
```c
fprintf(stderr, "bytes_rate formula is correct\n");  // 77è¡Œç›®
fprintf(stderr, "byte_offset(%ld) = byte_rate(%.2f) * need_second(%.2f)\n", ...);  // 85-86è¡Œç›®
fprintf(stderr, "result_offset(%ld) = data_offset(%ld) + byte_offset(%ld)\n", ...);  // 88-89è¡Œç›®
```

æœ¬ç•ªç’°å¢ƒã§ã¯å‰Šé™¤ã¾ãŸã¯æ¡ä»¶ä»˜ãã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨:

```c
#ifdef DEBUG
    fprintf(stderr, "bytes_rate formula is correct\n");
    fprintf(stderr, "byte_offset(%ld) = byte_rate(%.2f) * need_second(%.2f)\n", ...);
    fprintf(stderr, "result_offset(%ld) = data_offset(%ld) + byte_offset(%ld)\n", ...);
#endif
```

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã« `-DDEBUG` ã‚’ä»˜ã‘ã‚‹ã¨ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ãŒæœ‰åŠ¹ã«ãªã‚‹:
```bash
gcc -DDEBUG -o ex28_bin_10b ex28_bin_10b.c
```

---

## ğŸ“ ä¿®æ­£ç‰ˆã‚³ãƒ¼ãƒ‰ï¼ˆé‡è¦éƒ¨åˆ†ã®ã¿ï¼‰

### get_biné–¢æ•°ï¼ˆä¿®æ­£ä¸è¦ã€ã™ã§ã«æ­£ã—ã„ï¼‰

```c
int get_bin(FILE *fp, FmtHeader *fmt, int data_size, long data_offset, float need_second) {
    uint32_t bits_per_sample = fmt->bit_depth * fmt->channel_num;
    uint32_t bytes_per_sample = bits_per_sample / 8;
    uint32_t byte_rate = fmt->byte_rate;

    if (byte_rate != bytes_per_sample * fmt->sample_rate) {
        fprintf(stderr, "get_bin: byte_rate formula is incorrect\n");
        return -1;
    }

    float duration = (float)data_size / (float)byte_rate;
    if (duration < need_second) {
        fprintf(stderr, "get_bin: need_second is too big\n");
        return -1;
    }

    long byte_offset = (long)((float)byte_rate * need_second);
    long result_offset = data_offset + byte_offset;

    if (fseek(fp, result_offset, SEEK_SET) != 0) {
        fprintf(stderr, "fseek/get_bin: returned error\n");
        return -1;
    }

    int bin_data = 0;
    if (fread(&bin_data, bytes_per_sample, 1, fp) != 1) {
        fprintf(stderr, "fread/get_bin: returned error\n");
        return -1;
    }

    return bin_data;
}
```

### mainé–¢æ•°ï¼ˆä¿®æ­£ãŒå¿…è¦ï¼‰

```c
int main(int argc, char **argv) {
    // ... (å‰åŠçœç•¥) ...

    float need_second = atof(argv[2]);
    int bin_data = get_bin(fp, &fmt, data_size, data_offset, need_second);
    if (bin_data == -1) {
        fprintf(stderr, "get_bin/main: returned error\n");
        fclose(fp);  // âœ… è¿½åŠ : ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‰ã˜ã‚‹
        return 1;    // âœ… ä¿®æ­£: resultã§ã¯ãªã1ã‚’è¿”ã™
    }

    printf("=== Result ===\n");
    printf("bin: 0x%04X\n", (unsigned int)bin_data);  // âœ… æ”¹å–„: ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¿®æ­£

    fclose(fp);
    return 0;
}
```

---

## ğŸ“ å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆç·ã¾ã¨ã‚

### 1. ãƒ‡ãƒãƒƒã‚°ã®åŸºæœ¬å§¿å‹¢

1. **ä»®èª¬ã‚’ç«‹ã¦ã‚‹** â†’ ã‚³ãƒ¼ãƒ‰ã®å•é¡Œã ã¨æ€ã„è¾¼ã¾ãªã„
2. **è¤‡æ•°ã®æ–¹æ³•ã§æ¤œè¨¼** â†’ ãƒ—ãƒ­ã‚°ãƒ©ãƒ å‡ºåŠ›ã€xxdã€å¤–éƒ¨ãƒ„ãƒ¼ãƒ«
3. **æ®µéšçš„ã«èª¿æŸ»** â†’ è¨ˆç®—ãŒæ­£ã—ã„ã‹ â†’ ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ã„ã‹ â†’ ä»®å®šãŒæ­£ã—ã„ã‹
4. **å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª** â†’ æƒ³å®šã¨ç¾å®ŸãŒç•°ãªã‚‹ã“ã¨ã¯å¤šã„

### 2. å‹ã®ä½¿ã„åˆ†ã‘åŸå‰‡

| å ´é¢ | æ¨å¥¨å‹ | ç†ç”± |
|------|--------|------|
| WAVãƒ˜ãƒƒãƒ€ãƒ¼ | `uint16_t`, `uint32_t` | ã‚µã‚¤ã‚ºæ˜ç¢ºã€ç¬¦å·ä¸è¦ |
| ãƒ•ã‚¡ã‚¤ãƒ«ä½ç½® | `long` | fseek/ftelläº’æ› |
| æ™‚é–“è¨ˆç®— | `float` | å°æ•°ç‚¹å¿…é ˆ |
| ãƒã‚¤ãƒˆæ•° | `size_t` | fread/fwriteäº’æ› |
| ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ | `int` | è² ã®å€¤ã§åŒºåˆ¥å¯èƒ½ |

### 3. æµ®å‹•å°æ•°ç‚¹æ¼”ç®—ã®æ³¨æ„ç‚¹

```c
// âŒ é–“é•ã„
int result = data_size / byte_rate;  // æ•´æ•°é™¤ç®—

// âœ… æ­£ã—ã„
float result = (float)data_size / (float)byte_rate;  // ä¸¡æ–¹floatã«å¤‰æ›
```

### 4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®è¨­è¨ˆ

```c
// âœ… è‰¯ã„è¨­è¨ˆ: ã‚¨ãƒ©ãƒ¼ã¨ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†é›¢
int function() {
    if (error) return -1;  // ã‚¨ãƒ©ãƒ¼ã¯è² ã®å€¤
    return data;           // ãƒ‡ãƒ¼ã‚¿ã¯0ä»¥ä¸Š
}

// âŒ æ‚ªã„è¨­è¨ˆ: ã‚¨ãƒ©ãƒ¼ã¨ãƒ‡ãƒ¼ã‚¿ãŒæ··åœ¨
int function() {
    if (error) return 1;   // ãƒ‡ãƒ¼ã‚¿ãŒ1ã®å ´åˆã¨åŒºåˆ¥ã§ããªã„ï¼
    return data;
}
```

### 5. ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã®æ´»ç”¨

- **stderr** ã‚’ä½¿ã† â†’ æ­£è¦å‡ºåŠ›ã¨æ··ã–ã‚‰ãªã„
- **æ®µéšçš„ã«è¿½åŠ ** â†’ å•é¡Œã®ç®‡æ‰€ã‚’çµã‚Šè¾¼ã‚€
- **æ¡ä»¶ä»˜ãã‚³ãƒ³ãƒ‘ã‚¤ãƒ«** â†’ æœ¬ç•ªç’°å¢ƒã§ã¯ç„¡åŠ¹åŒ–
- **16é€²æ•°è¡¨ç¤º** â†’ ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã¯ç†è§£ã—ã‚„ã™ã„

### 6. å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã®æ´»ç”¨

- **xxd** â†’ ãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿéš›ã®ãƒã‚¤ãƒˆåˆ—ã‚’ç¢ºèªï¼ˆæœ€é‡è¦ï¼‰
- **Audacity** â†’ æ³¢å½¢ã‚’è¦–è¦šçš„ã«ç¢ºèª
- **SoX** â†’ ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§éŸ³å£°è§£æ
- **Python + librosa** â†’ ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ†ã‚£ãƒƒã‚¯ãªæ¤œè¨¼

### 7. æ•°å­¦çš„ç†è§£ã®é‡è¦æ€§

ä»Šå›ã®ã‚±ãƒ¼ã‚¹ã§ã¯ã€**440Hzã¨44100Hzã®æ•°å­¦çš„é–¢ä¿‚**ã‚’ç†è§£ã—ã¦ã„ãªã„ã¨ã€ã€Œ0.1ç§’ã”ã¨ã«0ã«ãªã‚‹ã€ã¨ã„ã†ç¾è±¡ãŒå¶ç„¶ãªã®ã‹å¿…ç„¶ãªã®ã‹åˆ¤æ–­ã§ããªã‹ã£ãŸã€‚

```
44100 / 440 = 100.227...
0.1ç§’ = 4410ã‚µãƒ³ãƒ—ãƒ« = 44å‘¨æœŸï¼ˆã¡ã‚‡ã†ã©æ•´æ•°ï¼‰â†’ ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹
```

ã“ã®ã‚ˆã†ãªæ•°å­¦çš„èƒŒæ™¯ã‚’ç†è§£ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒãƒƒã‚°ãŒåŠ¹ç‡çš„ã«ãªã‚‹ã€‚

### 8. ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä¿¡é ¼æ€§

æœ€çµ‚çš„ã«ã€ä»¥ä¸‹ã®3ã¤ã®æ–¹æ³•ã§æ¤œè¨¼ã—ã€ã™ã¹ã¦ãŒä¸€è‡´ï¼š
1. ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å‡ºåŠ›: `bin: 0`
2. xxdã§ã®ç›´æ¥ç¢ºèª: `00 00`
3. æ•°å­¦çš„è¨ˆç®—: ä½ç›¸0Â°ï¼ˆã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ï¼‰

â†’ **ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯æ­£ã—ãå‹•ä½œã—ã¦ã„ã‚‹** ã¨ã„ã†çµè«–ã«è‡³ã£ãŸã€‚

---

## ğŸ¯ æœ€çµ‚ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [x] å‹ã®ä½¿ã„åˆ†ã‘ãŒé©åˆ‡ï¼ˆuint32_t, long, float, size_tï¼‰
- [x] æµ®å‹•å°æ•°ç‚¹è¨ˆç®—ãŒæ­£ç¢ºï¼ˆæ˜ç¤ºçš„ãªã‚­ãƒ£ã‚¹ãƒˆï¼‰
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒçµ±ä¸€ï¼ˆ-1ã§çµ±ä¸€ï¼‰
- [ ] mainé–¢æ•°ã®ã‚¨ãƒ©ãƒ¼æ™‚ã«fcloseå®Ÿè¡Œï¼ˆè¦ä¿®æ­£ï¼‰
- [ ] mainé–¢æ•°ã®ã‚¨ãƒ©ãƒ¼æ™‚ã®æˆ»ã‚Šå€¤ä¿®æ­£ï¼ˆ`return result` â†’ `return 1`ï¼‰
- [ ] å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ”¹å–„ï¼ˆ`%0x` â†’ `%04X`ï¼‰
- [x] ãƒ•ã‚¡ã‚¤ãƒ«ä½ç½®è¨ˆç®—ãŒæ­£ç¢ºï¼ˆbyte_offset, result_offsetï¼‰
- [x] block_alignã«æƒã£ã¦ã„ã‚‹ï¼ˆè¨ºæ–­ã§ç¢ºèªæ¸ˆã¿ï¼‰
- [x] freadãŒæ­£ã—ãå‹•ä½œï¼ˆè¨ºæ–­ã§ç¢ºèªæ¸ˆã¿ï¼‰
- [x] xxdã§å®Ÿãƒ‡ãƒ¼ã‚¿ã¨ä¸€è‡´ç¢ºèªæ¸ˆã¿

---

## ğŸ”š çµè«–

**ex28_bin_10b.cã¯ã€ç´°ã‹ã„ä¿®æ­£ç‚¹ï¼ˆmainé–¢æ•°ã®ã‚¨ãƒ©ãƒ¼å‡¦ç†ï¼‰ã‚’é™¤ã„ã¦ã€æ­£ã—ãå‹•ä½œã—ã¦ã„ã¾ã™ã€‚**

ã€Œ0ãŒå‡ºã‚‹ã€ã¨ã„ã†ç¾è±¡ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒã‚°ã§ã¯ãªãã€440Hzæ­£å¼¦æ³¢ã¨44100Hzã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã®æ•°å­¦çš„é–¢ä¿‚ã«ã‚ˆã‚Šã€ã‚­ãƒªã®è‰¯ã„ç§’æ•°ï¼ˆ0.1, 0.2, ...ï¼‰ãŒã™ã¹ã¦ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ç‚¹ã«å¯¾å¿œã—ã¦ã„ãŸã“ã¨ãŒåŸå› ã§ã—ãŸã€‚

ã“ã®ãƒ‡ãƒãƒƒã‚°ãƒ—ãƒ­ã‚»ã‚¹ã‚’é€šã˜ã¦ã€ä»¥ä¸‹ã‚’å­¦ã³ã¾ã—ãŸ:
- stderrå‡ºåŠ›ã«ã‚ˆã‚‹æ®µéšçš„ãƒ‡ãƒãƒƒã‚°ã®æœ‰åŠ¹æ€§
- xxdãªã©å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã‚‹æ¤œè¨¼ã®é‡è¦æ€§
- Cè¨€èªã®å‹ã®ä½¿ã„åˆ†ã‘ã¨å‹å¤‰æ›ã®å®Ÿè·µçš„ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®è¨­è¨ˆåŸå‰‡
- æ•°å­¦çš„èƒŒæ™¯ã®ç†è§£ã®é‡è¦æ€§

ä»Šå¾Œã¯ã€ã€Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒãŠã‹ã—ã„ã€ã¨æ€ã£ãŸã‚‰ã€ã¾ãš**å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã§å®Ÿãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã™ã‚‹**ç¿’æ…£ã‚’ã¤ã‘ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚
